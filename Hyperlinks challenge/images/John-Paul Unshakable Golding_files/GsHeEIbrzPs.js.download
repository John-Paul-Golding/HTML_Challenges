if (self.CavalryLogger) { CavalryLogger.start_js(["4rzbG"]); }

__d("SearchInstantBootstrapEntityModule",["cx","fbt","Arbiter","BanzaiODS","Base64","BrowseClickLogger","ContextualComponent","CSS","CurrentUser","DOM","FacebarKeywordSearchUtils","PageTransitionsRegistrar","React","ReactDOM","ReactRenderer","Run","SearchBootstrapEntityModuleDebugUtil","SearchBootstrapEntityModuleUIConfig","SearchBootstrapEntityModuleUtil","SearchEntityModule.react","SearchEntityModuleServerConstants","SearchEntityModuleUIConfig","SearchWWWTrackableClientViewConfig","SubscriptionsHandler","URI","XUIPageNavigation.react","XUIPageNavigationGroup.react","XUIPageNavigationItem.react","XUISpinner.react","ge","generateBrowseSessionID","gkx"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i=[h._("All"),h._("Posts"),h._("People"),h._("Photos"),h._("Videos"),h._("Pages"),h._("Places"),h._("Groups"),h._("Apps"),h._("Events")],j=void 0;function a(a){__p&&__p();this.$10=[],this.$11=!1,this.$12=!1,this.$13=!1,this.$17=function(a){__p&&__p();this.$11=!1;if(!b("SearchBootstrapEntityModuleUtil").isTopTabURI(a))return;this.$13=!0;var c=void 0,d=b("FacebarKeywordSearchUtils").decodeFacebarURIParams(a);d!=null&&(this.$8=d.sid,c=d.bsid);c==null&&(c=b("generateBrowseSessionID")({appName:"www",edge:"keywords_search"}));this.$9=c;this.$4=b("SearchBootstrapEntityModuleUtil").getQueryFromURI(a);this.$18();this.$19(a);b("SearchBootstrapEntityModuleUIConfig").hasInstantLoading&&(this.$13&&this.$10.length>0&&(this.$20(),this.$21()),this.$22())}.bind(this),this.$25=function(a){if(this.$9==null)return;this.$10=b("SearchBootstrapEntityModuleUtil").transformRawBootstrapResultsToEntityModuleResults(a,this.$9)}.bind(this),this.$26=function(){this.$13=!1,b("SearchBootstrapEntityModuleUIConfig").hasInstantLoading&&this.$27(),b("SearchBootstrapEntityModuleDebugUtil").printDebugNotice(b("SearchBootstrapEntityModuleUIConfig").hasInstantLoading?"new_bem_with_instant_loading":"new_bem","shown")}.bind(this),this.$1=a.getCore(),this.$2=new(b("SubscriptionsHandler"))(),j=this}a.prototype.enable=function(){this.$7=b("ge")("content");if(this.$7==null)return;b("Run").onAfterLoad(function(){this.$14(),this.$2.addSubscriptions(b("Arbiter").subscribe("page_transition",function(){this.$15(),this.$16()}.bind(this))),this.$15(),this.$16()}.bind(this))};a.prototype.disable=function(){this.$2.release()};a.prototype.$15=function(){this.$11||(b("PageTransitionsRegistrar").registerHandler(this.$17),this.$11=!0)};a.prototype.$16=function(){__p&&__p();if(this.$12)return;var a=this.$7;if(a==null)return;a=b("ContextualComponent").closestToNode(a);if(a==null)return;a.onUnmount(function(){this.$23(),this.$12=!1}.bind(this));this.$12=!0};a.prototype.$23=function(){if(b("SearchBootstrapEntityModuleUIConfig").hasInstantLoading){if(b("SearchBootstrapEntityModuleUtil").isTopTabURI(b("URI").getNextURI())){this.$13&&this.$10.length===0&&(this.$20(),this.$21());return}this.$21();this.$20()}else this.$21()};a.prototype.$14=function(){__p&&__p();var c=b("DOM").create("div",{className:"_126b"});this.$3=b("DOM").create("div",{className:"_126c"},c);b("ReactRenderer").constructAndRenderComponentAcrossTransitions(b("XUISpinner.react"),{size:"large"},c);c=[this.$3];var a=b("SearchBootstrapEntityModuleUIConfig").hasTabBarPlaceholder?this.$24():null;a!=null&&c.push(a);this.$6=b("DOM").create("div",{className:"_126d"},c);b("DOM").appendContent(this.$6,this.$3);b("CSS").hide(this.$6);b("DOM").appendContent(document.body,this.$6)};a.prototype.$24=function(){var a=i.map(function(a,c){return b("React").createElement(b("XUIPageNavigationItem.react"),{className:"_4gsg",href:"#",key:c},a)}),c=b("DOM").create("div"),d=b("DOM").create("div",{className:"_5sqx _4-u2 _4-u8","aria-hidden":!0},b("DOM").create("div",{className:"_zz9 _5im-"},c));b("ReactRenderer").constructAndRenderComponentAcrossTransitions(b("XUIPageNavigation.react"),{children:b("React").createElement(b("XUIPageNavigationGroup.react"),null,a)},c);return d};a.prototype.$18=function(){var a=[];b("gkx")("AT6AJhPyszcjQNvdyZ_5WvLb_AWIf6QuatGdzEnoTW_afFudSL0JxM_uVqeOmWglj9HMsKEWmAUxPA2KKsv5vCxfs9Kd6MaHeMmJ0060v-A0CA")&&this.$4!=null&&(a=this.$1.getSquashedEntityIDsFromQueryString(this.$4),a==null&&(a=[]));b("Arbiter").inform("FacebarDataSource.getBootstrapMatches",{query:this.$4,callback:this.$25,whitelistedEntIds:a},b("Arbiter").BEHAVIOR_PERSISTENT)};a.prototype.$19=function(a){__p&&__p();var c=this.$4,d=this.$10;if(c==null||d.length===0)return;var e=void 0,f=a.getQueryData().ref,g=b("FacebarKeywordSearchUtils").decodeFacebarURIParams(a);g==null&&(e=f);f=d.map(function(a){return a.tuid});var h=this.$9;if(h==null)return;g=babelHelpers["extends"]({},g,{preloaded_entity_ids:f,preloaded_entity_type:d[0].type,ent_ids:this.$1.getSquashedEntityIDsFromQueryString(c),bsid:h});e!=null&&(g.ref=e);a.setQueryData(babelHelpers["extends"]({},a.getQueryData(),{ref:b("Base64").encode(JSON.stringify(g)).replace(/\=+$/,"")}))};a.prototype.$22=function(){__p&&__p();var a=this.$10,c=this.$4,d=this.$9;if(a==null||c==null||d==null)return;if(a.length===0){b("SearchBootstrapEntityModuleDebugUtil").printDebugNotice(b("SearchBootstrapEntityModuleUIConfig").hasInstantLoading?"new_bem_with_instant_loading":"new_bem","no_matches");return}var e=b("DOM").create("div",{"data-bt":JSON.stringify({session_id:d,typeahead_sid:this.$8})});b("BrowseClickLogger").init(e);var f=b("SearchBootstrapEntityModuleUtil").getTitleForResultType(a[0].type);d={plain_text_query:c,browse_query:"keywords_search("+c+")",results:a,module_role:b("SearchEntityModuleServerConstants").RESULT_TYPE_TO_MODULE_ROLE[a[0].type],result_type:a[0].type,num_results_to_show:b("SearchBootstrapEntityModuleUIConfig").numResultsToShow,client_view_config:b("SearchWWWTrackableClientViewConfig"),browse_session_id:d,module_style:b("SearchEntityModuleUIConfig").moduleStyle,title:f,see_more_uri:b("SearchBootstrapEntityModuleUtil").getSeeMoreURIForResults(a,c).toString(),logging_unit_id:b("SearchBootstrapEntityModuleUtil").generateUnitIDWithPrefix("www_bem"),has_module_guidelines:b("SearchEntityModuleUIConfig").hasModuleGuidelines,viewer_id:b("CurrentUser").getID(),is_bootstrap_entity_module:!0,should_render_footer:!1,typeahead_session_id:this.$8};this.$5!=null&&b("SearchBootstrapEntityModuleDebugUtil").printDebugNotice(b("SearchBootstrapEntityModuleUIConfig").hasInstantLoading?"new_bem_with_instant_loading":"new_bem","previous_bem_not_unmounted");this.$5=b("ReactRenderer").constructAndRenderComponentAcrossTransitions(b("SearchEntityModule.react"),d,e,this.$26);b("DOM").prependContent(this.$3,e)};a.prototype.$21=function(){var a=this.$5;if(a==null)return;var c=!1;a=b("ReactDOM").findDOMNode(a);a!=null&&a.parentNode!=null&&(c=b("ReactDOM").unmountComponentAtNode(a.parentNode));c||b("BanzaiODS").bumpEntityKey("search.www.bem.instant_bem","current_bem_did_not_unmount");this.$5=null;this.$13=!1};a.prototype.$27=function(){b("CSS").show(this.$6),this.$7!=null&&b("CSS").hide(this.$7)};a.prototype.$20=function(){this.$7!=null&&b("CSS").show(this.$7),b("CSS").hide(this.$6)};a.moveInsideWrapper=function(c){__p&&__p();if(j==null){b("SearchBootstrapEntityModuleDebugUtil").printDebugNotice(b("SearchBootstrapEntityModuleUIConfig").hasInstantLoading?"new_bem_with_instant_loading":"new_bem","bem_not_initialized");return}b("SearchBootstrapEntityModuleUIConfig").hasInstantLoading?j.$20():j.$22();var a=j.$5;if(a==null){b("SearchBootstrapEntityModuleDebugUtil").printDebugNotice(b("SearchBootstrapEntityModuleUIConfig").hasInstantLoading?"new_bem_with_instant_loading":"new_bem","no_module_found_on_instance");return}a=b("ReactDOM").findDOMNode(a);if(a==null){b("SearchBootstrapEntityModuleDebugUtil").printDebugNotice(b("SearchBootstrapEntityModuleUIConfig").hasInstantLoading?"new_bem_with_instant_loading":"new_bem","no_module_root_found");return}if(a.parentNode==null){b("SearchBootstrapEntityModuleDebugUtil").printDebugNotice(b("SearchBootstrapEntityModuleUIConfig").hasInstantLoading?"new_bem_with_instant_loading":"new_bem","no_parent_node_found_for_module_root");return}b("DOM").contains(document.body,c)||b("SearchBootstrapEntityModuleDebugUtil").printDebugNotice(b("SearchBootstrapEntityModuleUIConfig").hasInstantLoading?"new_bem_with_instant_loading":"new_bem","wrapper_not_in_dom");b("DOM").appendContent(c,a.parentNode)};e.exports=a}),null);